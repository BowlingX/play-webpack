play-webpack
------------

[![Codacy Badge](https://api.codacy.com/project/badge/Grade/4ca293d1006d4416a9aeb76bf323db6e)](https://www.codacy.com/app/bowlingx/play-webpack?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=BowlingX/play-webpack&amp;utm_campaign=Badge_Grade)
[![CircleCI](https://circleci.com/gh/BowlingX/play-webpack.svg?style=svg)](https://circleci.com/gh/BowlingX/play-webpack)

This play module will add support for `webpack` and server-side rendering of javascript 
with the build-in `nashorn` script engine.

## Requirements

- JDK 8
- scala 2.11
- play 2.5.10
- webpack

## Setup

Create a file in ~/project/play-webpack.sbt

    addSbtPlugin("com.bowlingx" %% "play-webpack-plugin" % "0.1.1")
    
Add the following dependencies:
    
    libraryDependencies += "com.bowlingx" %% "play-webpack" % "0.1.1"

The plugin will convert a webpack JSON manifest file (generated with https://github.com/kossnocorp/assets-webpack-plugin) to a scala object 
that can be used directly in play templates for example. The plugin is theoretically not limited to play. 
I will extend the project to support other frameworks in the future.

To make the assets available in your template file:

    TwirlKeys.templateImports += "com.bowlingx.webpack.WebpackManifest"

Sample JSON File (generated by `assets-webpack`):

    {
      "vendor": {
        "js": "/assets/compiled/vendor.js",
        "css": "/assets/compiled/vendor.css"
      },
      "server": {
        "js": "/assets/compiled/server.js"
      },
      "main": {
        "js": "/assets/compiled/main.js",
        "css": "/assets/compiled/main.css"
      },
      "manifest": {
        "js": "/assets/compiled/manifest.js"
      }
    }
    
Sample twirl Template:
    
    @(title: String)(content: Html)
    <!DOCTYPE html>
    <html lang="en">
        <head>
            <title>@title</title>
            @WebpackManifest.main.css.map { file =>
                <link rel="stylesheet" media="screen" href="@file">
            }
            <link rel="shortcut icon" type="image/png" href="@routes.Assets.versioned("images/favicon.png")">
        </head>
        <body>
            @content
            @Seq(WebpackManifest.manifest.js, WebpackManifest.vendor.js, WebpackManifest.main.js).flatten.map { file =>
                <script src="@file" type="text/javascript"></script>
            }
        </body>
    </html>

### Default Settings

The plugin defines the following configuration:

    webpack {
      # the default bundles to include
      prependBundles = ["manifest", "vendor"]
    
      # The object that is generated by the plugin (needs to implement `WebpackManifestType`)
      manifestClass = "com.bowlingx.webpack.WebpackManifest$"

      # The public path of the assets
      publicPath = "/assets/compiled"
      # The path where they are stored relative to project route
      serverPath = "/public/compiled"
    }

    play.modules.enabled += "com.bowlingx.ReactModule"
    
The default path of the manifest file (relative to project root)
    
    webpackManifest := file("conf/webpack-assets.json")

### Workflow

Any file changes (including manifest file) are picked up automatically and a recompilation is triggered, 
so the normal "change and reload" cycle that leads to a faster development experience is kept.
